# Changelog

| Date | Change |
|------|--------|
| 2026-02-26 | **Premium terminal UI + brand alignment** — Complete CLI visual overhaul: monochrome gradient ASCII banner aligned with elophanto.com brand palette (grey35→bright_white), visual context/budget bars with block characters color-coded green→yellow→red by usage, risk-colored approval panels (green for read-only, yellow for writes, red for destructive tools), varied spinners per phase (moon for thinking, bouncingBar for tool execution, earth for browser), tree-style execution step log via Rich.Tree, Rich.Rule dividers between sections, response panel subtitles with model/cost/time, boxed feature badges, styled goal/mind event badges. Shared helpers (`_build_banner`, `_visual_bar`, `_tool_risk_level`) across CLI files. Fixed telegram duplicate badge in gateway mode feature row |
| 2026-02-26 | **Email attachments + shell process group fix** — `email_send` and `email_reply` now support file attachments via `attachments` parameter (array of absolute file paths, 25 MB total limit). Both providers: AgentMail (base64-encoded per their API) and SMTP (MIME `MIMEBase` + `encode_base64` in `MIMEMultipart("mixed")`). Auto content-type detection via `mimetypes`. File existence and size validation. Shell timeout fix: `start_new_session=True` + `os.killpg()` kills the entire process group on timeout — previously only the shell was killed, leaving child processes (find, npm, ffmpeg) running as orphans at 100% CPU |
| 2026-02-26 | **Remotion video creation + smart skill matching** — New `remotion-best-practices` skill with 37 detailed rule files (3D, maps, charts, captions, voiceover, text animations, transitions, timing, audio visualization, and more). Full brownfield scaffold workflow: `npm init` + `npm install` (avoids interactive `npx create-video`), creates project files, builds React components, renders to MP4 — all from a single user prompt like "create a video of a bouncing ball". Every `shell_execute` command includes explicit `cd` to project directory (shell doesn't persist cwd). Added **smart skill matching** with trigger keywords for all skills — prompt optimization selects the best skill before the agent starts. **Shell command logging** — every `shell_execute` now logs `[shell] START/DONE/TIMEOUT/FAILED` with elapsed time, exit code, and stderr preview for debugging agent behavior. **Skill path hints** — `skill_read` response now includes `skill_dir` and `hint` so the agent knows absolute paths to rule files (was searching wrong directories). Node.js version references updated from 18+ to 22+ across all docs. Skills count: 60+ (was 28) |
| 2026-02-25 | **Full web dashboard (10 pages)** — Expanded the web dashboard from 3 pages (Chat, Tools, Skills) to 10 fully functional pages, all reading live data from backend managers via gateway commands. **Dashboard overview**: agent identity, autonomous mind status with budget bar, active goals with progress bars, schedule summary, connected channels (grouped by type), swarm agents, knowledge stats, learned capabilities. **Knowledge page**: file browser with scope filters, search, expandable rows that fetch and render actual chunk content (markdown-rendered with heading paths and token counts). **Mind page**: dedicated autonomous mind monitor with status/budget/config cards, markdown-rendered scratchpad, recent actions timeline, real-time event stream (wakeup/action/sleep/paused/resumed/error), start/stop controls, 15s auto-refresh. **Schedule page**: search + enabled/disabled filter, expandable rows with cron expressions, task goals, next/last run times. **Channels page**: gateway info card (endpoint, sessions, unified mode), connected clients list with channel type icons. **Settings page**: read-only config viewer with collapsible sections, enabled/disabled badges, nested key-value display. **History page**: tasks/evolution tabs with expandable rows, markdown-rendered summaries, relative timestamps, diff-style evolution entries. 8 new gateway commands (`dashboard`, `knowledge`, `knowledge_detail`, `schedules`, `channels`, `config`, `history`, `mind_status`, `mind_control`). EloPhanto logo in sidebar. Stale process cleanup on all start modes. README updated with real screenshots |
| 2026-02-25 | **Security hardening complete (all 7 gaps)** — Implemented the full security roadmap from `docs/27-SECURITY-HARDENING.md` across 4 phases. **Phase 1** (Gap 3): Runtime self-model — code-enforced `<runtime_state>` XML block rebuilt every turn with fingerprint verification, tool counts by permission level, authority tier, channel, storage quotas, and process tracking. `core/runtime_state.py`, integrated into system prompt. **Phase 2** (Gaps 1, 2, 4, 6): PII guard (`core/pii_guard.py`) with 14 regex patterns for SSNs, credit cards, emails+passwords, phone numbers, API keys, and more. Injection guard hardening. Authority tiers (owner/trusted/public) enforced at gateway. Resource exhaustion protection: conversation loop detection, background process registry with reaper, storage quotas with alerts. **Phase 3** (Gap 7): Swarm boundary security (`core/swarm_security.py`) — context sanitization strips PII and vault references from knowledge shared with sub-agents, diff scanning detects credential access/network calls/file traversal/system commands/new dependencies in PR output, environment isolation strips sensitive env vars (VAULT, SECRET, TOKEN, API_KEY, PASSWORD) from sub-agent tmux sessions, workspace isolation under `/tmp/elophanto/swarm/`, consolidated kill switch (timeout + diff size + blocked output), `AGENT_SECURITY_ALERT` gateway event. **Phase 4** (Gap 5): Provider transparency (`core/provider_tracker.py`) — per-provider tracking of finish_reason, truncation detection (finish_reason=length/content_filter + mid-sentence heuristic), fallback tracking, latency measurement, content filter counting. `LLMResponse` extended with finish_reason/latency_ms/fallback_from/suspected_truncated. `<providers>` XML block in runtime state. Database migrations for llm_usage table. Z.ai adapter captures finish_reason. Truncation warnings logged. 978 tests, zero regressions |
| 2026-02-25 | **Workspace directory + browser text selection + README overhaul** — New `agent.workspace` config option directs all agent-created files (apps, exports, downloads, scraped data, drafts) to a designated directory instead of cluttering the project root. Workspace path injected into runtime context and enforced via `<workspace_rule>` in system prompt. New `browser_select_text` tool for selecting text within elements — handles input/textarea (setSelectionRange), contenteditable (Range API with TreeWalker for nested formatting spans), and regular DOM elements. Essential for text styling workflows in rich text editors (Medium, Substack, Google Docs): select text then click formatting buttons. README demos completely rewritten: 5 new demos showcasing self-building tools, autonomous mind working overnight, agent swarm managing a dev team, identity bootstrap on first boot, and real Chrome browser with existing sessions. Comparison table updated with current competitors (Claude Code, Manus) |
| 2026-02-24 | **Data-driven autonomous mind** — Replaced static hardcoded priority stack with live state queries from all managers. Mind prompt now includes real goals (with checkpoint progress), scheduled tasks (with next run time), recent task memories, knowledge stats, and identity anchor (purpose + capabilities). `_build_prompt()` is now async, calling `_build_state_snapshot()` which queries goal_manager, scheduler, memory_manager, identity_manager, and knowledge DB — all fail-open. Bootstrap behavior: when state is empty, the mind takes initiative (explore tools, search for opportunities, create goals) instead of sleeping. Fixed pause/resume timer: user interaction now resets the wakeup timer to config default (`wakeup_seconds`) instead of waking immediately on stale timer. Fixed `CostTracker.task_cost` → `task_total` attribute error that crashed every think cycle |
| 2026-02-24 | **Autonomous Mind hotfix + detailed terminal display** — Fixed mind not starting when launched via `./start.sh` (default `elophanto chat`). Root cause: `_chat_gateway()` in `chat_cmd.py` had its own gateway startup that was missing GoalRunner, AutonomousMind, and EmailMonitor wiring. Also missing `unified_sessions` Gateway param. Added real-time tool use broadcasting during mind cycles — every tool call is now visible in the terminal as it happens (`mind_tool_use` event via executor `_on_tool_executed` callback). Enriched all mind events with budget, scratchpad preview, tool count, elapsed time, and cost data. Redesigned CLI mind display: visual separator lines frame each cycle, wakeup shows budget/memory/last action, each tool call shows with params, action shows summary with cost/time/tool count, sleep shows formatted duration with full budget status. 8 gateway event types (added `MIND_TOOL_USE`) |
| 2026-02-24 | **Autonomous Mind** — Purpose-driven background thinking loop that runs between user interactions. Every wakeup cycle: evaluate priority stack (active goals > revenue > pending tasks > capability gaps > presence growth), execute highest-value action, update scratchpad, schedule next wakeup. Pauses when user sends a message, resumes when task completes. Budget-isolated (configurable % of daily LLM budget, resets daily). LLM-controlled wakeup interval via `set_next_wakeup` tool (60s-1h). Persistent scratchpad (`data/scratchpad.md`) for working memory across cycles. Event broadcasting to all channels (wakeup, action, sleep, paused, resumed, revenue, error). `/mind` command shows live status. Conversation history isolated from user chat. 7 new gateway event types, 2 new tools (`set_next_wakeup`, `update_scratchpad`), config section with budget/timing/verbosity controls |
| 2026-02-24 | **Embedding auto-recovery + health dashboard** — Startup now detects broken embeddings (chunks exist but 0 vectors) and automatically forces a full re-index to recover. Fixes the case where `index_incremental()` skips unchanged files that had failed embeddings. CLI welcome panel shows knowledge health: "34 chunks, 34 embeddings" (green) or "34 chunks, 0 embeddings — search broken!" (red). Per-chunk embedding failures upgraded to ERROR level with model name. Added Google search instruction to planner step 2 (CHECK) so agent discovers new platforms instead of picking from memory |
| 2026-02-24 | **Browser vision routing** — Screenshots now routed through OpenRouter's vision model (`google/gemini-2.0-flash-001`) for text analysis when OpenRouter is configured. No OpenRouter = no vision, just pseudo-HTML + page content. Auto-screenshot after click/navigate/type saves to disk and returns pseudo-HTML elements — no base64 image data in tool results (was flooding GLM-4.7 text model context). Python-side safety strip removes `imageBase64` from all browser tool results before they reach the LLM |
| 2026-02-24 | **Fix embedding race condition** — Embedding model detection was running as `asyncio.create_task()` (background) while knowledge indexing ran synchronously after it, causing indexer to use wrong model name. All 31 chunks had zero embeddings. Fixed by awaiting detection before indexing. Also fixed OpenRouter embedding model default: `google/gemini-embedding-001` (was `qwen/qwen3-embedding-8b` which no longer exists) |
| 2026-02-24 | **Fix agent narration** — Reverted behavior section to proven f5f7f1b style. Verbose negative instructions ("Do NOT output a plan") paradoxically made the LLM narrate more. Simple positive framing works better. Added repetition check as step 2: knowledge_search before recurring tasks (posting, promoting, outreach) to avoid repeating past work |
| 2026-02-24 | **Agent Swarm** — Orchestrate external coding agents (Claude Code, Codex, Gemini CLI) as a one-person dev team. Everything controlled through conversation. `SwarmManager` (`core/swarm.py`) spawns agents in isolated git worktrees on feature branches, launches them in persistent tmux sessions with knowledge-enriched prompts, monitors PR creation and CI status, handles mid-task redirection via `tmux send-keys`, and auto-stops on timeout. 4 new tools: `swarm_spawn` (create agent with auto-profile selection), `swarm_status` (check agent status with tmux/PR/CI info), `swarm_redirect` (inject new instructions mid-task), `swarm_stop` (kill agent, preserve worktree). Config: `swarm:` section with profiles, concurrency limits, done criteria. DB persistence for restart survival. Gateway event broadcasting (AGENT_SPAWNED/COMPLETED/FAILED/REDIRECTED/STOPPED). New `swarm-orchestration` skill |
| 2026-02-24 | **Browser file upload** — Two new tools for uploading files and images through the browser. `browser_upload_file` sets files directly on `<input type="file">` elements by index (drills into wrappers to find nested file inputs). `browser_file_chooser` handles buttons/areas that open a native file dialog — pre-registers a `filechooser` event listener, clicks the trigger, intercepts the dialog, and sets files. Both verify file existence, accept absolute paths, and support multiple files. Added to vision model allowed set + action parser + cheat sheet. System prompt includes file upload protocol with decision logic (visible file input → `browser_upload_file`, upload button/drop zone → `browser_file_chooser`) |
| 2026-02-24 | **EKO DOM tree port** — Replaced CSS-selector-based element identification with EKO's full DOM tree traversal system. Recursive DOM walk including iframes and shadow DOM, comprehensive interactivity detection (ARIA roles, event listeners, cursor styling, contenteditable, draggable), `isTopElement()` via `elementFromPoint()` to exclude elements behind modals, colored bounding box overlays (12 cycling colors) with index labels, pseudo-HTML output format (`[15]:<button class="primary">Submit</button>`), combined `takeScreenshotWithElements()` for index consistency, `getXPathTree()` for element identification, `create_area_map()` for bounding rect export, `getElementEventListeners()` for `on*` handler detection. Added `browser_press_key`/`browser_type_text`/`browser_select_option` to vision model tool cheat sheet + allowed set + action parser. Fallback to legacy method if DOM tree injection fails |
| 2026-02-24 | **Goal persistence** — Fixed browser agent losing track of the user's task after a few tool calls (e.g., creating Notes instead of Articles on Substack). Current goal now anchored in system prompt (`CURRENT TASK:` in runtime_context), forwarded to browser bridge via `set_task_context` JSON-RPC, and injected into vision model prompt. New `goal_persistence` protocol in browser section explicitly prevents UI confusion (Note vs Article, Quick Post vs New Post). Task completion criteria strengthened: clicking a button is not completion, must verify with screenshot. New `PUBLISH VERIFICATION` protocol: handle confirmation dialogs, verify content is actually live before reporting success |
| 2026-02-24 | **Agent Swarm doc** — New `docs/25-AGENT-SWARM.md` describing how EloPhanto orchestrates CLI coding agents (Claude Code, Codex, Gemini CLI) as a one-person dev team. Two-tier context architecture, tmux process management, git worktrees for isolation, automated monitoring, mid-task redirection, multi-model code review, self-improving prompts, proactive work discovery |
| 2026-02-24 | **Browser post-click wait** — Fixed publish/save/submit buttons getting stuck in loading state. After every click, the browser bridge now waits up to 3s for network idle (was 500ms). Screenshot capture also waits for network idle instead of a fixed 500ms race. System prompt updated with ASYNC BUTTONS guidance so the LLM doesn't re-click loading buttons |
| 2026-02-24 | **Browser rich text editor fix** — Fixed content corruption and deletion when editing pages with rich text editors (Substack/Slate, Medium/ProseMirror, etc.). The browser bridge was directly setting `textContent` on contenteditable elements, bypassing the editor's internal state and causing duplication or data loss. Now detects contenteditable elements and uses `document.execCommand('insertText')` with proper select-all, which goes through the browser's editing pipeline and keeps editor state in sync. Regular inputs/textareas unchanged |
| 2026-02-24 | **Cross-channel forwarding fix** — Fixed Telegram messages not appearing in CLI (and vice versa) after `/clear` or gateway restart. Clients were only subscribed to the unified session broadcast when they sent a chat message, so after session deletion they lost their subscription. Now auto-subscribes all clients on connection, and `/clear` re-subscribes all connected clients to the new session |
| 2026-02-23 | **Vault auto-backup** — Vault now automatically backs up before every write. `_save()` copies `vault.enc` to `vault.enc.bak` before overwriting. `Vault.create()` backs up both `vault.salt` and `vault.enc` before re-initialization, preventing accidental data loss. New `elophanto vault restore` CLI command restores from the most recent backup. Protects credentials, TOTP secrets, wallet keys, and email config |
| 2026-02-23 | **`/clear` session + memory wipe** — `/clear` now actually works in unified session mode. Previously it only reset the local CLI session ID while the gateway kept returning the same conversation. Now it deletes the session from the database AND wipes all task memories so the agent starts completely fresh. New `SessionManager.delete()` and `MemoryManager.clear_all()` methods, gateway `clear` command handler |
| 2026-02-23 | **TOTP authenticator** — Own 2FA authenticator (like Google Authenticator). 4 tools: `totp_enroll` (store Base32 secrets from service setup pages), `totp_generate` (generate 6-digit codes with TTL awareness), `totp_list` (list enrolled services), `totp_delete` (remove secrets). Secrets encrypted in vault, never exposed to LLM. Verification priority system in system prompt (email > TOTP > SMS > push). SMS verification handled conversationally. 33 tests |
| 2026-02-23 | **Background inbox monitoring** — Agent can monitor its own email inbox in the background and push notifications to all connected channels (CLI, Telegram, Discord, Slack) when new emails arrive. Controlled via conversation: "monitor your inbox" starts it, "stop monitoring" stops it. Silent first poll (seeds seen IDs, no notification flood), seen ID persistence across restarts, configurable poll interval (default 5 min). New `email_monitor` tool with start/stop/status actions, `core/email_monitor.py` polling loop, cross-channel notification display in all 4 adapters. 30 tests |
| 2026-02-23 | **Prompt injection defense** — Multi-layer guard against indirect prompt injection attacks via websites, emails, and documents. System prompt trust hierarchy teaches the LLM to treat external content as data. Tool output wrapping marks external results as untrusted. Pattern scanner detects common injection signatures (instruction overrides, role switches, exfiltration attempts, delimiter attacks) and flags them. Gateway input sanitization closes filename injection vectors. New `core/injection_guard.py` module, 35 tests |
| 2026-02-23 | **Unified cross-channel sessions** — All channels (CLI, Telegram, Discord, Slack) now share one conversation by default (`gateway.unified_sessions: true`). Chat from Telegram, see it in CLI, and vice versa. Cross-channel message forwarding shows what was said on other channels. Responses broadcast to all connected channels. Set `unified_sessions: false` for per-channel isolation |
| 2026-02-23 | **Autonomous background goal execution** — Goals now execute checkpoint-by-checkpoint in the background without waiting for user messages. `GoalRunner` class (`core/goal_runner.py`) uses `asyncio.create_task()` per checkpoint via `agent.run()`. Safety limits: 2h total time, $5 cost budget, LLM call cap. Conversation history isolated per checkpoint. Progress events broadcast to all channels (CLI, Telegram, Discord, Slack). User message auto-pauses goal. Auto-resume on agent restart. 12 new tests |
| 2026-02-23 | **Ctrl+C request cancellation** — Pressing Ctrl+C during agent processing now cancels the current request and returns to the prompt instead of killing the terminal. Gateway spawns chat handling as cancellable tasks, CLI sends cancel command on interrupt. Also added `/stop` command. Double Ctrl+C within 1 second force-exits (safety valve). Goal lifecycle events displayed in CLI (started, checkpoint complete, completed, paused, resumed) |
| 2026-02-22 | **Response speed fix** — Eliminated 25-40 second delay on every response caused by post-task housekeeping (identity reflection, task memory, dataset collection) blocking the reply. All post-task work now runs as fire-and-forget background tasks via `asyncio.create_task()`. Embedding detection moved to non-blocking startup. Response time dropped from 30+ seconds to ~4 seconds |
| 2026-02-22 | **Self-learning dataset builder** — Opt-in only (`self_learning.enabled: false` by default). Agent-side data collection pipeline for training. Captures task interactions, sanitizes locally (14 secret patterns, PII, browser data), enriches with training signals (user sentiment, denial/error detection, turn count), buffers in local SQLite, uploads in batches to elophanto.com collection API. Auto-registration via census fingerprint, key recovery on conflict. Server-side: collect endpoint, daily cron pushes to HuggingFace Datasets as JSONL. Collects both successes and failures for DPO/RLHF training. Only collects interactions with tool use (no greetings/chat). 42 tests |
| 2026-02-22 | **MCP integration** — Native MCP client support: connect to any MCP server and its tools appear alongside built-in tools. Dual transport (stdio + Streamable HTTP), vault-referenced secrets, per-server permissions. Agent self-management via `mcp_manage` tool (install SDK, add/remove/test servers through conversation). `elophanto mcp` CLI commands (list, add, remove, test). Init wizard step 8 with presets (filesystem, GitHub, Brave Search). Auto-install SDK on startup. System prompt integration. Welcome panel shows `mcp (N)` with connected server count |
| 2026-02-21 | **Agent Census** — Anonymous startup heartbeat for ecosystem statistics. SHA-256 machine fingerprint (survives reinstall), fire-and-forget with 3s timeout, zero PII. Payload: agent_id + version + platform + python version. `core/census.py` module, integrated in `Agent.initialize()`, 15 tests |
| 2026-02-21 | **Hosted platform spec** — Hybrid distribution: Tauri desktop app (free, local-first) + Fly.io cloud instances (pro, always-on) at elophanto.com. Per-user container isolation, Supabase auth, Stripe billing, shared web dashboard, wake-on-request for hibernated instances, data portability between local and cloud |
| 2026-02-21 | **EloPhantoHub security P0 implemented** — Content security policy with 16 blocked patterns + 5 warning patterns enforced at skill load time (`core/skills.py`), SHA-256 checksum verification on hub install (`core/hub.py`), skill revocation detection + quarantine to `_revoked/`, runtime safety guidance in system prompt (`core/planner.py`), skill origin tagging (source/tier/warnings in XML), enhanced `installed.json` with backward compat, 24 security tests |
| 2026-02-20 | **EloPhantoHub supply chain security spec** — 7-layer defense-in-depth design for skill marketplace security: publisher verification with tier system (New -> Verified -> Trusted -> Official), automated CI scanning (malicious patterns, prompt injection, obfuscation), human review for new publishers, SHA-256 integrity checksums, content security policy (blocked/warning patterns enforced at load time), runtime protection (permission system, skill origin tagging), incident response with revocation broadcast |
| 2026-02-20 | **Agent email** — Own email inbox with dual provider support: AgentMail (cloud API, zero config) or SMTP/IMAP (your own server). 6 tools (email_create_inbox, email_send, email_list, email_read, email_reply, email_search), email-agent skill with verification flow patterns, identity integration (inbox stored in beliefs), audit logging via email_log table. Chat-based setup |
| 2026-02-19 | **Crypto payments** — Agent's own wallet on Base with dual provider support: local self-custody wallet (default, zero config, eth-account) and Coinbase AgentKit (optional, managed custody, gasless, DEX swaps). 7 payment tools, spending limits ($100/txn, $500/day, $5K/month), full audit trail, preview-before-execute protocol, chat-based setup |
| 2026-02-19 | **Evolving identity** — IdentityManager discovers identity on first run via LLM, evolves personality/values/capabilities through task reflection, maintains a living `knowledge/self/nature.md` document, tracks credential accounts in beliefs. 3 new tools, 45 new tests |
| 2026-02-19 | **Autonomous goal loop** — GoalManager decomposes complex goals into ordered checkpoints, persists progress across sessions, summarizes context to stay within token limits, self-evaluates and revises plans. 3 new tools, goals skill, 61 new tests |
| 2026-02-19 | **Document & media analysis** — PDF, DOCX, XLSX, PPTX, EPUB, image extraction with OCR (rapidocr), RAG collections for large documents, 3 new tools, Telegram file/photo intake |
| 2026-02-19 | Fix `/stats`, `/clear`, `/help` commands in gateway CLI mode |
| 2026-02-19 | Add EloPhanto logo assets |
| 2026-02-18 | Initial commit — EloPhanto v0.1.0 (foundation, knowledge, permissions, browser, self-dev, vault, scheduling, Telegram, skills, gateway, channels, EloPhantoHub) |
